<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Drug Dose Response Curves: Fitting and Plotting • CBWWorkshop2024</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Drug Dose Response Curves: Fitting and Plotting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CBWWorkshop2024</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9028</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/PGx_2024.html">Pharmacogenomic Analysis of Drug Combination Experiments to Identify Biomarkers of Response or Resistance</a></li>
    <li><a class="dropdown-item" href="../articles/Workshop_Outline.html">Workshop Outline and Objectives</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Module Labs</h6></li>
    <li><a class="dropdown-item" href="../articles/Module1.html">Module 1: Introduction to pharmacogenomics</a></li>
    <li><a class="dropdown-item" href="../articles/Module2.html">Module 2: Hands-on with pharmacogenomics data</a></li>
    <li><a class="dropdown-item" href="../articles/Module3.html">Module 3: Pharmacogenomics for biomarker discovery – Basic analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Module4.html">Module 4: Pharmacogenomics for biomarker discovery - Advanced analysis</a></li>
    <li><a class="dropdown-item" href="../articles/CurveFitting.html">Drug Dose Response Curves: Fitting and Plotting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bhklab/CBWWorkshop2024"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Drug Dose Response Curves: Fitting and Plotting</h1>
                        <h4 data-toc-skip class="author">Jermiah J.
Joseph</h4>
            <address class="author_afil">
      Princess Margaret Cancer
Centre<br><a class="author_email" href="mailto:#"></a><a href="mailto:jermiah.joseph@uhn.ca" class="email">jermiah.joseph@uhn.ca</a>
      </address>
                  
            <h4 data-toc-skip class="date">18 October 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bhklab/CBWWorkshop2024/blob/main/vignettes/CurveFitting.Rmd" class="external-link"><code>vignettes/CurveFitting.Rmd</code></a></small>
      <div class="d-none name"><code>CurveFitting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="generate-profiles-for-a-single-sample-and-treatment">Generate Profiles for a Single Sample and Treatment<a class="anchor" aria-label="anchor" href="#generate-profiles-for-a-single-sample-and-treatment"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pset</span> <span class="op">&lt;-</span> <span class="fu">CBWWorkshop2024</span><span class="fu">::</span><span class="va"><a href="../reference/dummy_pset.html">dummy_pset</a></span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">pset</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold; font-style: italic;">&lt;PharmacoSet&gt;</span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">#&gt; Name: </span><span style="color: #00BB00;">dummy_pset</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold; font-style: italic;">Date Created: </span><span style="color: #00BB00;">Tue Oct 15 23:31:41 2024</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold; font-style: italic;">Number of samples: </span> <span style="color: #00BB00;">50</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold; font-style: italic;">Molecular profiles: &lt;MultiAssayExperiment&gt; </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;">ExperimentList class object of length 2: </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;"> [1] </span><span style="color: #BB0000;">rnaseq.tpm</span> <span style="color: #00BB00;">: SummarizedExperiment with 100 rows and 50 columns </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;"> [2] </span><span style="color: #BB0000;">rnaseq.tpm.batch</span> <span style="color: #00BB00;">: SummarizedExperiment with 100 rows and 50 columns </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span><span style="color: #BBBB00; font-weight: bold; font-style: italic;">Treatment response: &lt;TreatmentResponseExperiment&gt; </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;">dim:  4847 52 </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;">assays(1): </span><span style="color: #BB0000;">sensitivity</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">rownames(4847): </span><span style="color: #00BB00;">1e-07:Ixabepilone:1 1e-06:Ixabepilone:1 ... 1000:Nelarabine:1 4000:Ifosfamide:1</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">rowData(4): </span><span style="color: #00BB00;">treatmentdose treatmentid tech_rep CONC1</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">colnames(52): </span><span style="color: #00BB00;">786-O:1 A-498:1 A-549:1 ... UACC-257:1 UACC-62:1 UO-31:1</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">colData(3): </span><span style="color: #00BB00;">sampleid bio_rep PANEL</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">metadata(0): </span><span style="color: #00BB00;">none</span></span></span>
<span><span class="va">SAMPLE_OF_INTEREST</span> <span class="op">&lt;-</span> <span class="st">"786-O"</span></span>
<span><span class="va">TREATMENT_OF_INTEREST</span> <span class="op">&lt;-</span> <span class="st">"Ixabepilone"</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">pset</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Get the TreatmentResponseExperiment</span></span>
<span>  <span class="fu">treatmentResponse</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Filter the data to a single sample and treatment</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>    <span class="va">treatmentid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">TREATMENT_OF_INTEREST</span>, </span>
<span>    <span class="va">sampleid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">SAMPLE_OF_INTEREST</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Group By to average out technical replicates</span></span>
<span>  <span class="fu">CoreGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>    viability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span>,</span>
<span>    assay <span class="op">=</span> <span class="st">"sensitivity"</span>,</span>
<span>    target <span class="op">=</span> <span class="st">"mean_sensitivity"</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatmentid"</span>, <span class="st">"treatmentdose"</span>, <span class="st">"sampleid"</span>, <span class="st">"bio_rep"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Fit the dose-response curve</span></span>
<span>  <span class="fu">CoreGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CoreGx/man/endoaggregate.html" class="external-link">endoaggregate</a></span><span class="op">(</span></span>
<span>    <span class="op">{</span></span>
<span>      <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PharmacoGx/man/logLogisticRegression.html" class="external-link">logLogisticRegression</a></span><span class="op">(</span><span class="va">treatmentdose</span>, <span class="va">viability</span><span class="op">)</span></span>
<span>      <span class="va">IC50</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PharmacoGx/man/computeICn.html" class="external-link">computeIC50</a></span><span class="op">(</span><span class="va">treatmentdose</span>, Hill_fit <span class="op">=</span> <span class="va">fit</span><span class="op">)</span></span>
<span>      <span class="va">AAC</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PharmacoGx/man/computeAUC.html" class="external-link">computeAUC</a></span><span class="op">(</span><span class="va">treatmentdose</span>, Hill_fit <span class="op">=</span> <span class="va">fit</span>, area.type <span class="op">=</span> <span class="st">"Fitted"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        HS <span class="op">=</span> <span class="va">fit</span><span class="op">[[</span><span class="st">"HS"</span><span class="op">]</span><span class="op">]</span>, E_inf <span class="op">=</span> <span class="va">fit</span><span class="op">[[</span><span class="st">"E_inf"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="fl">100</span>, EC50 <span class="op">=</span> <span class="va">fit</span><span class="op">[[</span><span class="st">"EC50"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        Rsq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        AAC <span class="op">=</span> <span class="va">AAC</span>,</span>
<span>        IC50 <span class="op">=</span> <span class="va">IC50</span>,</span>
<span>        min_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">treatmentdose</span><span class="op">)</span>,</span>
<span>        max_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">treatmentdose</span><span class="op">)</span>,</span>
<span>        max_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span>,</span>
<span>        min_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">viability</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    assay <span class="op">=</span> <span class="st">"mean_sensitivity"</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatmentid"</span>, <span class="st">"sampleid"</span>, <span class="st">"bio_rep"</span><span class="op">)</span>,</span>
<span>    enlist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    target <span class="op">=</span> <span class="st">"profiles"</span></span>
<span>  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tre_profiled</span></span>
<span><span class="va">tre_profiled</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold; font-style: italic;">&lt;TreatmentResponseExperiment&gt; </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold; font-style: italic;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;">dim:  35 1 </span></span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">#&gt; </span>   <span style="color: #BBBB00; font-weight: bold;">assays(3): </span><span style="color: #BB0000;">sensitivity mean_sensitivity profiles</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">rownames(35): </span><span style="color: #00BB00;">1e-07:Ixabepilone:1 1e-06:Ixabepilone:1 ... 0.3:Ixabepilone:7 0.3:Ixabepilone:8</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">rowData(4): </span><span style="color: #00BB00;">treatmentdose treatmentid tech_rep CONC1</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">colnames(1): </span><span style="color: #00BB00;">786-O:1</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">colData(3): </span><span style="color: #00BB00;">sampleid bio_rep PANEL</span> </span></span>
<span><span class="co">#&gt;    <span style="color: #BBBB00; font-weight: bold;">metadata(0): </span><span style="color: #00BB00;">none</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="helper-function-to-plot-the-curve">Helper function to plot the curve<a class="anchor" aria-label="anchor" href="#helper-function-to-plot-the-curve"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#' @title Plot a dose-response curve</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @description This function plots a dose-response curve for a given sample and treatment</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @details This function takes a `CoreGx::TreatmentResponseExperiment` object and plots a dose-response curve for a given sample and treatment. The curve is fitted using the Hill equation.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param tre `CoreGx::TreatmentResponseExperiment` object</span></span>
<span><span class="co">#' @param sampleid `character` sample id</span></span>
<span><span class="co">#' @param treatmentid `character` treatment id</span></span>
<span><span class="co">#' @param raw_assay_name `character` name of the raw assay</span></span>
<span><span class="co">#' @param profiles_assay_name `character` name of the profiles assay</span></span>
<span><span class="co">#' @param HS_colname `character` name of the HS column</span></span>
<span><span class="co">#' @param E_inf_colname `character` name of the E_inf column</span></span>
<span><span class="co">#' @param EC50_colname `character` name of the EC50 column</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return NULL</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">plot_curve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">tre</span>,</span>
<span>    <span class="va">sampleid</span>,</span>
<span>    <span class="va">treatmentid</span>,</span>
<span>    <span class="va">mono_assay_name</span> <span class="op">=</span> <span class="st">"sensitivity"</span>,</span>
<span>    <span class="va">profiles_assay_name</span> <span class="op">=</span> <span class="st">"profiles"</span>,</span>
<span>    <span class="va">HS_colname</span> <span class="op">=</span> <span class="st">"HS"</span>,</span>
<span>    <span class="va">E_inf_colname</span> <span class="op">=</span> <span class="st">"E_inf"</span>,</span>
<span>    <span class="va">EC50_colname</span> <span class="op">=</span> <span class="st">"EC50"</span></span>
<span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">mono_assay</span> <span class="op">&lt;-</span> <span class="va">tre</span><span class="op">[[</span><span class="va">mono_assay_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span></span>
<span>    <span class="va">treatmentid</span> <span class="op">==</span> <span class="va">treatmentid</span> <span class="op">&amp;</span> <span class="va">sampleid</span> <span class="op">==</span> <span class="va">sampleid</span></span>
<span>  <span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">profile_assay</span> <span class="op">&lt;-</span> <span class="va">tre</span><span class="op">[[</span><span class="va">profiles_assay_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span></span>
<span>    <span class="va">treatmentid</span> <span class="op">==</span> <span class="va">treatmentid</span> <span class="op">&amp;</span> <span class="va">sampleid</span> <span class="op">==</span> <span class="va">sampleid</span></span>
<span>  <span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">min_dose</span> <span class="op">&lt;-</span> <span class="va">profile_assay</span><span class="op">$</span><span class="va">min_dose</span></span>
<span>  <span class="va">max_dose</span> <span class="op">&lt;-</span> <span class="va">profile_assay</span><span class="op">$</span><span class="va">max_dose</span></span>
<span>  </span>
<span>  <span class="va">pseudo_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">min_dose</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">max_dose</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">pseudo_y</span> <span class="op">&lt;-</span> <span class="fu">PharmacoGx</span><span class="fu">:::</span><span class="fu">.Hill</span><span class="op">(</span></span>
<span>    <span class="va">pseudo_x</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">profile_assay</span><span class="op">[[</span><span class="va">HS_colname</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      <span class="va">profile_assay</span><span class="op">[[</span><span class="va">E_inf_colname</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">profile_assay</span><span class="op">[[</span><span class="va">EC50_colname</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    treatmentdose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">mono_assay</span><span class="op">$</span><span class="va">treatmentdose</span><span class="op">)</span>,</span>
<span>    viability <span class="op">=</span> <span class="va">mono_assay</span><span class="op">$</span><span class="va">viability</span> <span class="op">/</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">pseudo_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    pseudo_x <span class="op">=</span> <span class="va">pseudo_x</span>,</span>
<span>    pseudo_y <span class="op">=</span> <span class="va">pseudo_y</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatmentdose</span>, y <span class="op">=</span> <span class="va">viability</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Points</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pseudo_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pseudo_x</span>, y <span class="op">=</span> <span class="va">pseudo_y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Fitted curve</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Dose-Response Curve for"</span>, <span class="va">treatmentid</span>, <span class="st">"("</span>, <span class="va">sampleid</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"Log10 Treatment Dose"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Viability"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-the-curve">Plot the curve<a class="anchor" aria-label="anchor" href="#plot-the-curve"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_curve</span><span class="op">(</span></span>
<span>  tre <span class="op">=</span> <span class="va">tre_profiled</span>, </span>
<span>  sampleid <span class="op">=</span> <span class="va">SAMPLE_OF_INTEREST</span>, </span>
<span>  treatmentid <span class="op">=</span> <span class="va">TREATMENT_OF_INTEREST</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="CurveFitting_files/figure-html/plot-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jermiah Joseph, Julia Nguyen, Nikta Feizi, Canadian Bioinformatics Workshop,Bioinformatics.ca.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
